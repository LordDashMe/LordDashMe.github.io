{"version":3,"sources":["webpack:///./src/pages/ph-covid19-tracker/components/Chart/StatusPieChart.tsx"],"names":["ReactChartJS2","loadable","fallback","StatusPieChart","properties","state","statusPieChart","data","getStatusPieChartData","options","getStatusPieChartOptions","totalConfirmedCases","percentageVisibility","percentageValue","componentDidMount","isSSR","this","fetchProjectsOnFireStore","labels","datasets","label","backgroundColor","borderColor","borderWidth","hoverBorderColor","hoverBorderWidth","mouseout","alert","maintainAspectRatio","legend","display","boxWidth","fontSize","fontColor","fontFamily","tooltips","bodyFontFamily","custom","tooltip","opacity","unsetPercentageValue","onClick","chartEvent","chartState","_index","setPercentageValue","onHover","currentState","setState","specificIndex","specificCaseCount","parseFloat","toFixed","Firestore","clearInstance","initialize","getInstance","collection","orderBy","get","then","querySnapshot","docs","count","statusOverview","filter","doc","sys_id","map","document","id","color","details","getPercentage","className","style","render","type","width","height","Component"],"mappings":"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","file":"components-Chart-StatusPieChart-490e3a4cd0452f8edb15.js","sourcesContent":["import React, { Component } from 'react';\nimport loadable from '@loadable/component';\n\nimport { isSSR } from '../../../../common/helper';\n\nimport Firestore from '../../../../components/Database/Firebase/Firestore';\n\nconst ReactChartJS2 = loadable(() => import('react-chartjs-2'), { fallback: null });\n\nimport style from './StatusPieChart.module.scss';\n\ninterface IProperty {}\n\ninterface IState {\n  statusPieChart: IStatusPieChart;\n  totalConfirmedCases: number;\n  percentageVisibility: boolean;\n  percentageValue: number;\n};\n\ninterface IStatusPieChart {\n  data: object;\n  options: object;\n}\n\ninterface IStatusOverview {\n  id: string;\n  sys_id: string;\n  label: string;\n  count: number;\n  color: string;\n}\n\nexport default class StatusPieChart extends Component<IProperty, IState> {\n\n  public constructor(properties: any) {\n    \n    super(properties);\n\n    this.state = {\n      statusPieChart: {\n        data: this.getStatusPieChartData(),\n        options: this.getStatusPieChartOptions()\n      },\n      totalConfirmedCases: 0,\n      percentageVisibility: false,\n      percentageValue: 0,\n    };\n  }\n\n  public componentDidMount(): void {\n    if (! isSSR()) {\n      this.fetchProjectsOnFireStore(); \n    }\n  }\n\n  private getStatusPieChartData(): object {\n    return {\n      labels: [\n        'INFECTED',\n        'RECOVERED',\n        'DEATHS'\n      ],\n      datasets: [\n        {\n          label: 'COVID-19',\n          data: [\n            0,\n            10,\n            0\n          ],\n          backgroundColor: [\n            '#e29e01',\n            '#60a138',\n            '#a13838'\n          ],\n          borderColor: '#fff',\n          borderWidth: 1,\n          hoverBorderColor: [\n            '#ccc',\n            '#ccc',\n            '#ccc'\n          ],\n          hoverBorderWidth: 4,\n          mouseout: () => {\n            alert();\n          }\n        }\n      ]\n    };\n  }\n\n  private getStatusPieChartOptions(): object {\n    return {\n      maintainAspectRatio: false,\n      legend: {\n        display: false,\n        labels: {\n          boxWidth: 16,\n          fontSize: 14,\n          fontColor: '#000',\n          fontFamily: 'Montserrat, \"Helvetica Neue\", Helvetica, Arial, sans-serif'\n        }\n      },\n      tooltips: {\n        bodyFontFamily: 'Montserrat, \"Helvetica Neue\", Helvetica, Arial, sans-serif',\n        custom: (tooltip: any): void => {\n          if (tooltip.opacity <= 0) {\n            this.unsetPercentageValue();\n          }\n        }\n      },\n      onClick: (chartEvent: any, chartState: any): void => {\n        if (!chartState || typeof chartState[0] === 'undefined' || !chartState[0]) {\n          return;\n        }\n        if (typeof chartState[0]._index !== 'undefined') {\n          this.setPercentageValue(chartState[0]._index);\n        }\n      },\n      onHover: (chartEvent: any, chartState: any): void => {\n        if (!chartState || typeof chartState[0] === 'undefined' || !chartState[0]) {\n          return;\n        }\n        if (typeof chartState[0]._index !== 'undefined') {\n          this.setPercentageValue(chartState[0]._index);\n        }\n      }\n    };\n  }\n\n  private unsetPercentageValue(): void {\n\n    const currentState = {...this.state};\n\n    currentState.percentageVisibility = false;\n    currentState.percentageValue = 0;\n\n    this.setState(currentState);\n  }\n\n  private setPercentageValue(specificIndex: number): void {\n\n    const currentState = {...this.state};\n    const specificCaseCount = currentState.statusPieChart.data['datasets'][0].data[specificIndex];\n\n    currentState.percentageVisibility = true;\n    currentState.percentageValue = parseFloat(((specificCaseCount / currentState.totalConfirmedCases) * 100).toFixed(2));\n\n    this.setState(currentState);\n  }\n\n  private fetchProjectsOnFireStore(): void {\n    \n    Firestore.clearInstance();\n    Firestore.initialize();\n    Firestore.getInstance()\n      .collection('ph-covid19-tracker-status-overview')\n      .orderBy('order', 'desc')\n      .get()\n      .then((querySnapshot: any): void => { \n\n        const totalConfirmedCases = querySnapshot.docs[0].data().count;\n        \n        const statusOverview = (querySnapshot.docs)\n          .filter((doc: any): IStatusOverview | boolean => {\n            const document = doc.data();\n            if (document.sys_id === 'confirmed_cases') {\n              return false;\n            } \n            return doc;\n          }).map((doc: any): IStatusOverview => {\n          const document = doc.data();\n            return {\n              id: doc.id,\n              sys_id: document.sys_id,\n              label: document.label,\n              count: document.count,\n              color: document.color\n            };\n          });\n\n        const currentState = {...this.state};\n\n        currentState.statusPieChart.data['labels'] = statusOverview.map((details: IStatusOverview): string => {\n          return details.label;\n        });\n\n        currentState.statusPieChart.data['datasets'][0]['data'] = statusOverview.map((details: IStatusOverview): number => {\n          return details.count; \n        });\n\n        currentState.statusPieChart.data['datasets'][0]['backgroundColor'] = statusOverview.map((details: IStatusOverview): string => {\n          return details.color;\n        });\n\n        currentState.totalConfirmedCases = totalConfirmedCases;\n        \n        this.setState(currentState);\n      });\n  }\n\n  private getPercentage(): JSX.Element {\n    \n    if (this.state.percentageVisibility) {\n      return (\n        <div className={style['percentage-wrapper']}>\n          <div className={style['percentage']}><span id=\"percentage-value\">{this.state.percentageValue}</span>%</div>\n        </div>\n      );\n    }\n\n    return (<div></div>);\n  }\n\n  public render(): JSX.Element {\n    return (\n      <div id=\"ph-covid19-tracker-chart-status-pie-chart-component\" className={style['container']}>\n        {this.getPercentage()}\n        <ReactChartJS2 data={this.state.statusPieChart.data} options={this.state.statusPieChart.options} type={'pie'} width={350} height={350} />\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}